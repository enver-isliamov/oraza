<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="theme-color" content="#c49a3c" id="metaThemeColor">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="–†–∞–º–∞–¥–∞–Ω">
<meta name="description" content="–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ò–º—Å–∞–∫ –∏ –ò—Ñ—Ç–∞—Ä. –†–∞–º–∞–¥–∞–Ω 1447. –ö—Ä—ã–º.">
<link rel="manifest" href="manifest.json">
<link rel="icon" type="image/png" href="logo.png">
<link rel="icon" type="image/svg+xml" href="logo.svg">
<link rel="shortcut icon" href="logo.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="logo.png">
<title>–†–∞–º–∞–¥–∞–Ω 1447 ¬∑ –ö—Ä—ã–º</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700;800;900&family=Cormorant+Garamond:wght@600;700&family=Smooch+Sans:wght@700;800&display=swap" rel="stylesheet">
<style>
:root{--imsak:#d94f5c;--imsak-soft:rgba(217,79,92,0.1);--iftar:#1fa86a;--iftar-soft:rgba(31,168,106,0.1);--gold:#c49a3c;--gold-soft:rgba(196,154,60,0.13);--bg:#f6f3ee;--surface:#ffffff;--surface2:#efebe4;--surface3:#e6e0d7;--text:#1a1612;--text2:#5a5248;--text3:#998f85;--border:rgba(26,22,18,0.09);--shadow-sm:0 1px 4px rgba(26,22,18,0.07),0 2px 8px rgba(26,22,18,0.05);--shadow:0 2px 12px rgba(26,22,18,0.08),0 4px 20px rgba(26,22,18,0.06);--shadow-lg:0 8px 32px rgba(26,22,18,0.12),0 2px 8px rgba(26,22,18,0.08);--r:16px;--r-sm:10px;--font-body:'Nunito',sans-serif;--font-display:'Cormorant Garamond',serif;}
[data-theme="dark"]{--bg:#100e0c;--surface:#1b1814;--surface2:#252019;--surface3:#2e2820;--text:#f0ebe4;--text2:#a09588;--text3:#66605a;--border:rgba(240,235,228,0.08);--shadow-sm:0 1px 4px rgba(0,0,0,0.25),0 2px 8px rgba(0,0,0,0.2);--shadow:0 2px 12px rgba(0,0,0,0.35),0 4px 20px rgba(0,0,0,0.25);--shadow-lg:0 8px 32px rgba(0,0,0,0.5),0 2px 8px rgba(0,0,0,0.3);}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
body{font-family:var(--font-body);background:var(--bg);color:var(--text);min-height:100vh;transition:background .3s,color .3s;-webkit-font-smoothing:antialiased;overscroll-behavior:none;touch-action:manipulation;}
.topbar{position:sticky;top:0;z-index:50;background:var(--bg);border-bottom:1px solid var(--border);padding-top:env(safe-area-inset-top,0px);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);transition:background .3s;}
.topbar-inner{max-width:480px;margin:0 auto;padding:11px 14px;display:flex;align-items:center;gap:8px;min-width:0;}
.brand{flex:1;min-width:0;font-family:var(--font-display);font-size:1.15rem;font-weight:700;color:var(--text);letter-spacing:-.01em;line-height:1.1;}
.brand em{color:var(--gold);font-style:normal;}
.brand small{display:block;font-family:var(--font-body);font-size:.6rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;color:var(--text3);margin-top:1px;}
.topbar-actions{display:flex;gap:6px;align-items:center;min-width:0;}
.city-btn{display:flex;align-items:center;gap:5px;padding:6px 10px;border-radius:9px;border:1px solid var(--border);background:var(--surface);color:var(--text);cursor:pointer;font-family:var(--font-body);font-size:.76rem;font-weight:800;box-shadow:var(--shadow-sm);transition:all .15s;white-space:nowrap;-webkit-tap-highlight-color:transparent;max-width:clamp(96px,36vw,120px);}
#cityLabel{min-width:0;overflow:hidden;text-overflow:ellipsis;}
.city-btn:active{transform:scale(.96);}
.city-dot{width:5px;height:5px;border-radius:50%;background:var(--gold);flex-shrink:0;}
.icon-btn{width:34px;height:34px;border-radius:9px;border:1px solid var(--border);background:var(--surface);color:var(--text);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;box-shadow:var(--shadow-sm);transition:all .15s;flex-shrink:0;-webkit-tap-highlight-color:transparent;}
.icon-btn:active{transform:scale(.93);}
.icon-btn.theme-active{background:var(--gold-soft);border-color:rgba(196,154,60,.3);}
.icon-btn.aod-active{background:var(--iftar-soft);border-color:rgba(31,168,106,.35);color:var(--iftar);}
.fitir-card{background:linear-gradient(135deg,rgba(196,154,60,.13) 0%,rgba(196,154,60,.05) 100%);border:1px solid rgba(196,154,60,.22);border-radius:var(--r);padding:16px 16px 14px;margin-bottom:10px;position:relative;overflow:hidden;display:block;color:inherit;text-decoration:none;}
.fitir-card::before{content:'';position:absolute;top:-20px;right:-20px;width:80px;height:80px;background:radial-gradient(circle,rgba(196,154,60,.15),transparent 70%);pointer-events:none;}
.fitir-header{display:flex;align-items:center;gap:10px;margin-bottom:10px;}
.fitir-ico{font-size:1.3rem;flex-shrink:0;}
.fitir-title{font-size:.78rem;font-weight:800;color:var(--gold);letter-spacing:.04em;text-transform:uppercase;}
.fitir-title small{display:block;font-size:.65rem;font-weight:600;color:var(--text3);text-transform:none;letter-spacing:0;margin-top:1px;}
.fitir-body{font-size:.8rem;font-weight:600;color:var(--text2);line-height:1.6;}
.fitir-amount{display:inline-block;background:var(--gold);color:#fff;font-size:.88rem;font-weight:800;padding:4px 12px;border-radius:100px;margin-top:8px;letter-spacing:.02em;text-decoration:none;}
.share-list{display:flex;flex-direction:column;gap:7px;}
.share-item{display:flex;align-items:center;gap:12px;padding:13px 14px;border-radius:var(--r-sm);border:1px solid var(--border);background:var(--surface2);cursor:pointer;transition:all .12s;-webkit-tap-highlight-color:transparent;}
.share-item:active{transform:scale(.98);}
.share-ico{font-size:1.3rem;flex-shrink:0;width:32px;text-align:center;}
.share-name{font-size:.85rem;font-weight:700;color:var(--text);}
.share-desc{font-size:.7rem;font-weight:500;color:var(--text3);}
.share-divider{text-align:center;font-size:.65rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;color:var(--text3);padding:4px 0;}
.main{max-width:480px;margin:0 auto;padding:14px 14px calc(10px + env(safe-area-inset-bottom,0px));}
.install-banner{background:linear-gradient(135deg,var(--gold-soft),rgba(196,154,60,.06));border:1px solid rgba(196,154,60,.25);border-radius:var(--r-sm);padding:12px 13px;display:flex;align-items:center;gap:10px;margin-bottom:10px;cursor:pointer;-webkit-tap-highlight-color:transparent;}
.install-banner:active{opacity:.85;}
.ib-icon{font-size:1.4rem;flex-shrink:0;}
.ib-text{flex:1;}
.ib-title{font-size:.82rem;font-weight:800;color:var(--text);margin-bottom:1px;}
.ib-sub{font-size:.7rem;font-weight:500;color:var(--text3);}
.ib-close{background:none;border:none;cursor:pointer;font-size:1rem;color:var(--text3);padding:4px;-webkit-tap-highlight-color:transparent;}
.day-nav{display:flex;align-items:center;gap:8px;margin-bottom:12px;}
.nav-arrow{width:38px;height:38px;border-radius:10px;border:1px solid var(--border);background:var(--surface);color:var(--text);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:18px;box-shadow:var(--shadow-sm);transition:all .15s;flex-shrink:0;-webkit-tap-highlight-color:transparent;user-select:none;}
.nav-arrow:disabled{opacity:.25;cursor:default;pointer-events:none;}
.nav-arrow:not(:disabled):active{transform:scale(.92);background:var(--surface2);}
.nav-center{flex:1;display:grid;grid-template-columns:minmax(0,1fr) auto;align-items:center;gap:10px;padding:7px 9px;border-radius:10px;background:var(--surface);border:1px solid var(--border);box-shadow:var(--shadow-sm);}
.nav-meta{min-width:0;display:flex;flex-direction:column;gap:2px;text-align:left;}
.nav-time-wrap{display:flex;align-items:center;justify-content:flex-end;}
.nav-clock{display:inline-flex;align-items:baseline;gap:0;color:var(--text);font-family:'Smooch Sans',var(--font-body),sans-serif;font-weight:800;font-variant-numeric:tabular-nums;}
.nav-clock-part{display:inline-block;min-width:2ch;text-align:center;}
.nav-clock-main{font-size:2.3rem;line-height:.9;letter-spacing:.03em;}
.nav-clock-colon{display:inline-block;min-width:.55ch;text-align:center;font-size:2.3rem;line-height:.9;opacity:.9;}
.nav-clock-sec{font-size:2.3rem;line-height:.9;letter-spacing:.03em;display:inline-block;animation:secondPulse 1s steps(1,end) infinite;}
@keyframes secondPulse{0%,49%{opacity:.62;}50%,100%{opacity:1;}}
.nav-date-main{font-size:.81rem;font-weight:800;color:var(--text);line-height:1.2;}
.nav-date-sub{display:none;}
.nav-today-chip{display:inline-flex;align-items:center;width:fit-content;margin:0 0 2px;padding:2px 8px;border-radius:2px;background:var(--gold);color:#fff;font-size:.45rem;font-weight:500;letter-spacing:.08em;text-transform:uppercase;}
.nav-ramadan-day{text-align:center;margin-top:5px;font-size:.7rem;font-weight:800;color:var(--gold);letter-spacing:.03em;}
.chip{display:inline-block;font-size:.56rem;font-weight:800;padding:1px 6px;border-radius:100px;letter-spacing:.07em;text-transform:uppercase;vertical-align:middle;margin-left:5px;}
.chip-today{background:var(--gold);color:#fff;}
.chip-laylat{background:rgba(196,154,60,.2);color:var(--gold);}
.chip-bayram{background:rgba(31,168,106,.15);color:var(--iftar);}
.hero-grid{display:grid;grid-template-columns:1fr 1fr;gap:9px;margin-bottom:10px;}
.hero-card{border-radius:var(--r);padding:16px 14px 14px;cursor:pointer;position:relative;overflow:hidden;border:1px solid transparent;transition:transform .18s,box-shadow .18s;-webkit-tap-highlight-color:transparent;user-select:none;}
.hero-card:active{transform:scale(.965);}
.hero-card::after{content:'‚Üó';position:absolute;top:11px;right:12px;font-size:.68rem;font-weight:700;opacity:.28;}
.hero-card.imsak-card{background:linear-gradient(150deg,rgba(217,79,92,.11) 0%,rgba(217,79,92,.03) 100%);border-color:rgba(217,79,92,.18);box-shadow:inset 0 1px 0 rgba(255,255,255,.5),var(--shadow-sm);}
.hero-card.iftar-card{background:linear-gradient(150deg,rgba(31,168,106,.11) 0%,rgba(31,168,106,.03) 100%);border-color:rgba(31,168,106,.18);box-shadow:inset 0 1px 0 rgba(255,255,255,.5),var(--shadow-sm);}
[data-theme="dark"] .hero-card{box-shadow:none;}
.card-type{font-size:.62rem;font-weight:800;letter-spacing:.1em;text-transform:uppercase;margin-bottom:7px;}
.imsak-card .card-type{color:var(--imsak);}
.iftar-card .card-type{color:var(--iftar);}
.card-time{font-family:var(--font-display);font-size:2.5rem;font-weight:700;letter-spacing:-.02em;line-height:1;margin-bottom:5px;}
.imsak-card .card-time{color:var(--imsak);}
.iftar-card .card-time{color:var(--iftar);}
.card-name{font-size:.72rem;font-weight:700;color:var(--text2);}
.card-tap-hint{font-size:.6rem;font-weight:600;color:var(--text3);margin-top:3px;}
.status-grid{display:grid;grid-template-columns:2fr 1fr;gap:9px;align-items:stretch;margin-bottom:10px;}
.progress-bar{background:var(--surface);border-radius:var(--r-sm);padding:12px 14px;border:1px solid var(--border);box-shadow:var(--shadow-sm);margin-bottom:0;}
.useful-tile{position:relative;display:flex;flex-direction:column;justify-content:center;gap:5px;text-decoration:none;padding:12px 10px;border-radius:var(--r-sm);border:1px solid rgba(196,154,60,.24);background:linear-gradient(145deg,rgba(196,154,60,.16),rgba(196,154,60,.04));box-shadow:var(--shadow-sm);}
.useful-badge{position:absolute;right:7px;bottom:7px;min-width:17px;height:17px;padding:0 5px;border-radius:999px;background:#d94f5c;color:#fff;font-size:.6rem;font-weight:900;display:none;align-items:center;justify-content:center;box-shadow:0 2px 8px rgba(217,79,92,.35);animation:quickPulse 1.1s ease-in-out infinite;}
.useful-badge.show{display:inline-flex;}
@keyframes quickPulse{0%,100%{transform:scale(1);opacity:.95}50%{transform:scale(1.14);opacity:1}}
.useful-eyebrow{font-size:.6rem;font-weight:900;letter-spacing:.08em;text-transform:uppercase;color:var(--gold);}
.useful-title{font-size:.86rem;font-weight:800;line-height:1.1;color:var(--text);}
.useful-hint{font-size:.64rem;font-weight:700;color:var(--text2);}
.progress-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;}
.progress-label{font-size:.75rem;font-weight:700;color:var(--text2);display:flex;align-items:center;gap:5px;}
.live-dot{width:5px;height:5px;border-radius:50%;background:currentColor;display:inline-block;animation:pulse 2s infinite;}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}
.progress-countdown{font-size:.85rem;font-weight:800;color:var(--gold);}
.progress-track{height:4px;background:var(--surface3);border-radius:100px;overflow:hidden;}
.progress-fill{height:100%;border-radius:100px;transition:width 1s linear;}
.notice{display:flex;gap:10px;padding:11px 13px;border-radius:var(--r-sm);margin-bottom:9px;border:1px solid;}
.notice.laylat{background:var(--gold-soft);border-color:rgba(196,154,60,.2);}
.notice.bayram{background:var(--iftar-soft);border-color:rgba(31,168,106,.2);}
.notice-ico{font-size:1.1rem;flex-shrink:0;margin-top:1px;}
.notice-title{font-size:.8rem;font-weight:800;color:var(--text);margin-bottom:1px;}
.notice-body{font-size:.74rem;font-weight:600;color:var(--text2);line-height:1.4;}
.tabs-wrap{background:var(--surface);border-radius:var(--r-sm);padding:3px;display:flex;gap:2px;border:1px solid var(--border);margin-bottom:14px;box-shadow:var(--shadow-sm);}
.tabs-wrap-top{margin-top:6px;}
.tab{flex:1;padding:8px 4px;border-radius:8px;border:none;background:transparent;color:var(--text3);font-family:var(--font-body);font-size:.76rem;font-weight:800;cursor:pointer;transition:all .18s;text-align:center;-webkit-tap-highlight-color:transparent;}
.tab.active{background:var(--text);color:var(--bg);box-shadow:0 1px 6px rgba(0,0,0,.15);}
.section-lbl{font-size:.65rem;font-weight:800;letter-spacing:.1em;text-transform:uppercase;color:var(--text3);margin-bottom:9px;padding-left:2px;}
.list-card{background:var(--surface);border-radius:var(--r);border:1px solid var(--border);overflow:hidden;box-shadow:var(--shadow-sm);}
.list-head{display:grid;grid-template-columns:minmax(176px,1.9fr) 68px 68px;padding:8px 14px;background:var(--surface2);border-bottom:1px solid var(--border);}
.list-head span{font-size:.6rem;font-weight:800;letter-spacing:.1em;text-transform:uppercase;color:var(--text3);}
.list-head .lh-imsak{color:var(--imsak);}
.list-head .lh-iftar{color:var(--iftar);}
.list-row{display:grid;grid-template-columns:minmax(176px,1.9fr) 68px 68px;padding:10px 14px;border-bottom:1px solid var(--border);align-items:center;column-gap:8px;cursor:pointer;position:relative;transition:background .12s;-webkit-tap-highlight-color:transparent;}
.list-row:last-child{border-bottom:none;}
.list-row:active{background:var(--surface2);}
.list-row.lr-today{background:linear-gradient(90deg,rgba(196,154,60,.09) 0%,transparent 70%);}
.list-row.lr-today::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;background:var(--gold);border-radius:0 2px 2px 0;}
.list-row.lr-laylat{background:linear-gradient(90deg,rgba(196,154,60,.09) 0%,transparent 70%);}
.list-row.lr-bayram{background:linear-gradient(90deg,rgba(31,168,106,.07) 0%,transparent 70%);}
.lr-date{display:flex;flex-direction:column;gap:3px;min-width:0;}
.lr-date-day{font-size:.6rem;font-weight:800;color:var(--text3);letter-spacing:.06em;text-transform:uppercase;}
.lr-date-main{display:flex;align-items:baseline;gap:8px;flex-wrap:wrap;}
.lr-date-num{font-size:.92rem;font-weight:800;line-height:1.1;color:var(--text);}
.lr-date-ramadan{font-size:.58rem;font-weight:800;color:var(--gold);line-height:1.2;}
.lr-badge{display:block;width:fit-content;font-size:.54rem;font-weight:800;padding:1px 5px;border-radius:4px;margin-top:2px;letter-spacing:.05em;text-transform:uppercase;}
.b-today{background:var(--gold);color:#fff;}
.b-laylat{background:rgba(196,154,60,.18);color:var(--gold);}
.b-bayram{background:rgba(31,168,106,.15);color:var(--iftar);}
.lr-imsak{font-size:.92rem;font-weight:700;color:var(--imsak);font-variant-numeric:tabular-nums;}
.lr-iftar{font-size:.92rem;font-weight:700;color:var(--iftar);font-variant-numeric:tabular-nums;}
.week-nav{display:flex;align-items:center;gap:8px;margin-bottom:11px;}
.week-nav-lbl{flex:1;text-align:center;font-size:.78rem;font-weight:700;color:var(--text2);}
.month-grid-header{display:grid;grid-template-columns:repeat(7,1fr);gap:3px;margin-bottom:3px;}
.mgh-day{text-align:center;font-size:.6rem;font-weight:800;letter-spacing:.05em;text-transform:uppercase;color:var(--text3);padding:2px 0;}
.month-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:3px;}
.mg-cell{background:var(--surface);border-radius:9px;border:1px solid var(--border);padding:5px 3px;text-align:center;min-height:66px;display:flex;flex-direction:column;align-items:center;gap:2px;cursor:pointer;position:relative;transition:all .12s;-webkit-tap-highlight-color:transparent;}
.mg-cell:active{transform:scale(.94);}
.mg-cell.mc-today{background:var(--gold-soft);border-color:rgba(196,154,60,.3);}
.mg-cell.mc-laylat{background:var(--gold-soft);border-color:rgba(196,154,60,.25);}
.mg-cell.mc-bayram{background:var(--iftar-soft);border-color:rgba(31,168,106,.2);}
.mg-cell.mc-empty{background:transparent;border-color:transparent;cursor:default;}
.mc-num{font-size:1rem;font-weight:800;color:var(--text);line-height:1;}
.mc-ramadan{font-size:.5rem;font-weight:700;color:var(--gold);line-height:1.2;}
.mc-imsak{font-size:.55rem;font-weight:700;color:var(--imsak);line-height:1.3;}
.mc-iftar{font-size:.55rem;font-weight:700;color:var(--iftar);line-height:1.3;}
.mc-bayram-title{font-size:.56rem;font-weight:900;color:var(--iftar);letter-spacing:.03em;text-transform:uppercase;line-height:1.25;}
.mc-bayram-note{font-size:.48rem;font-weight:800;color:var(--iftar);letter-spacing:.04em;text-transform:uppercase;line-height:1.2;}
.mc-bayram-time{font-size:.52rem;font-weight:800;color:var(--iftar);line-height:1.25;}
.mc-badge{position:absolute;top:2px;right:3px;font-size:.55rem;}
.overlay{position:fixed;inset:0;background:rgba(10,8,6,.5);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);z-index:200;display:flex;align-items:flex-end;justify-content:center;opacity:0;pointer-events:none;transition:opacity .22s;}
.overlay.open{opacity:1;pointer-events:all;}
.sheet{background:var(--surface);border-radius:22px 22px 0 0;width:100%;max-width:480px;padding:0 18px calc(24px + env(safe-area-inset-bottom,0px));transform:translateY(100%);transition:transform .3s cubic-bezier(.32,.72,0,1);max-height:88vh;overflow-y:auto;-webkit-overflow-scrolling:touch;}
.overlay.open .sheet{transform:translateY(0);}
.sheet-pull{position:sticky;top:0;background:var(--surface);padding:14px 0 10px;z-index:1;text-align:center;}
.sheet-handle{width:36px;height:4px;background:var(--border);border-radius:100px;margin:0 auto;}
.sheet-title{font-size:1.1rem;font-weight:800;color:var(--text);margin-bottom:3px;margin-top:14px;}
.sheet-sub{font-size:.77rem;font-weight:600;color:var(--text3);margin-bottom:18px;}
.city-list{display:flex;flex-direction:column;gap:5px;}
.city-item{display:flex;align-items:center;justify-content:space-between;padding:12px 13px;border-radius:var(--r-sm);border:1px solid var(--border);background:var(--surface2);cursor:pointer;transition:all .12s;-webkit-tap-highlight-color:transparent;}
.city-item:active{transform:scale(.98);}
.city-item.ci-active{background:var(--gold-soft);border-color:rgba(196,154,60,.3);}
.ci-name{font-size:.86rem;font-weight:700;color:var(--text);}
.ci-offset{font-size:.7rem;font-weight:500;color:var(--text3);}
.ci-check{font-size:1rem;color:var(--gold);}
.prayer-badge{display:inline-flex;align-items:center;gap:5px;padding:4px 10px;border-radius:100px;font-size:.68rem;font-weight:800;margin-bottom:12px;}
.pb-imsak{background:var(--imsak-soft);color:var(--imsak);}
.pb-iftar{background:var(--iftar-soft);color:var(--iftar);}
.prayer-time{font-family:var(--font-display);font-size:2.4rem;font-weight:700;line-height:1;margin-bottom:4px;}
.prayer-city{font-size:.74rem;font-weight:600;color:var(--text3);margin-bottom:14px;}
.prayer-card{background:var(--surface2);border-radius:var(--r-sm);padding:16px;border:1px solid var(--border);}
.prayer-arabic{font-family:var(--font-display);font-size:1.35rem;line-height:2;text-align:right;direction:rtl;color:var(--gold);margin-bottom:12px;}
.prayer-translit{font-size:.78rem;font-weight:600;font-style:italic;color:var(--text3);margin-bottom:10px;line-height:1.5;}
.prayer-translation{font-size:.82rem;font-weight:600;color:var(--text2);line-height:1.65;}
.prayer-note{margin-top:12px;padding:10px 12px;background:var(--surface3);border-radius:8px;font-size:.7rem;font-weight:600;color:var(--text3);line-height:1.5;}
.settings-group{margin-bottom:20px;}
.settings-group-title{font-size:.62rem;font-weight:800;letter-spacing:.1em;text-transform:uppercase;color:var(--text3);margin-bottom:8px;padding-left:2px;}
.settings-item{display:flex;align-items:center;justify-content:space-between;padding:12px 13px;border-radius:var(--r-sm);background:var(--surface2);border:1px solid var(--border);margin-bottom:5px;}
.si-label{font-size:.84rem;font-weight:700;color:var(--text);}
.si-sub{font-size:.7rem;font-weight:500;color:var(--text3);}
.si-right{display:flex;gap:5px;}
.app-footer{max-width:480px;margin:0 auto;padding:0 14px 14px;text-align:center;}
.footer-inner{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:10px 12px;box-shadow:var(--shadow-sm);}
.footer-made{font-size:.72rem;font-weight:600;color:var(--text3);line-height:1.45;margin-bottom:4px;}
.footer-tg{font-size:.67rem;font-weight:600;color:var(--text3);}
.footer-tg a{color:var(--gold);text-decoration:none;font-weight:700;}
.support-link{display:inline-flex;align-items:center;gap:6px;font-size:.72rem;font-weight:700;color:var(--text2);text-decoration:none;padding:6px 11px;border-radius:999px;border:1px solid var(--border);background:var(--surface2);transition:all .15s;-webkit-tap-highlight-color:transparent;}
.support-link:active{transform:scale(.97);}
.gratitude-card{margin:10px 0 14px;padding:10px 10px 9px;border-radius:14px;border:1px solid rgba(31,168,106,.18);background:linear-gradient(150deg,rgba(31,168,106,.11) 0%,rgba(31,168,106,.03) 100%);box-shadow:inset 0 1px 0 rgba(255,255,255,.5),var(--shadow-sm);}
.gratitude-main{display:grid;grid-template-columns:minmax(0,1fr) auto;gap:10px;align-items:center;}
.gratitude-copy{min-width:0;}
.gratitude-eyebrow{font-size:.66rem;font-weight:900;letter-spacing:.08em;text-transform:uppercase;color:var(--iftar);margin-bottom:5px;}
.gratitude-sub{font-size:.69rem;font-weight:600;color:var(--text2);line-height:1.35;}
.gratitude-cta{display:inline-flex;align-items:center;justify-content:center;white-space:nowrap;min-width:126px;padding:11px 16px;border-radius:12px;border:1px solid rgba(31,168,106,.24);background:linear-gradient(180deg,rgba(31,168,106,.95),rgba(31,168,106,.82));color:#fff;text-decoration:none;font-size:.72rem;font-weight:700;letter-spacing:.01em;box-shadow:0 2px 4px rgba(31,168,106,.2);transition:transform .15s,filter .15s;-webkit-tap-highlight-color:transparent;}
.gratitude-cta:active{transform:scale(.98);filter:brightness(.96);}

.bottom-actions{display:flex;gap:8px;margin-bottom:0;}
.bottom-btn{flex:1;padding:12px 10px;border-radius:var(--r-sm);border:1px solid var(--border);background:var(--surface);color:var(--text);font-family:var(--font-body);font-size:.78rem;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:6px;box-shadow:var(--shadow-sm);transition:all .15s;-webkit-tap-highlight-color:transparent;}
.bottom-btn:active{transform:scale(.97);}
.bottom-btn-primary{background:var(--text);color:var(--bg);border-color:var(--text);}
.cal-btn{display:flex;align-items:center;justify-content:center;gap:8px;width:100%;padding:13px 16px;border-radius:var(--r-sm);border:1px solid var(--border);background:var(--surface2);color:var(--text);font-family:var(--font-body);font-size:.83rem;font-weight:700;cursor:pointer;transition:all .12s;margin-bottom:7px;-webkit-tap-highlight-color:transparent;}
.cal-btn:active{transform:scale(.98);}
.cal-btn-primary{background:var(--text);color:var(--bg);border-color:var(--text);}
.cal-btn-primary:active{opacity:.85;}
.cal-hint{padding:11px 13px;border-radius:var(--r-sm);background:var(--surface2);border:1px solid var(--border);font-size:.72rem;font-weight:600;color:var(--text3);line-height:1.5;margin-top:4px;}
.cal-hint strong{color:var(--text2);font-weight:700;}
.install-guide{background:var(--surface2);border-radius:var(--r-sm);padding:16px;margin-bottom:10px;border:1px solid var(--border);}
.ig-title{font-size:.84rem;font-weight:800;color:var(--text);margin-bottom:10px;}
.ig-body{font-size:.8rem;font-weight:600;color:var(--text2);line-height:1.7;}
.sticky-footer{position:static;bottom:0;left:0;right:0;padding:10px 14px calc(12px + env(safe-area-inset-bottom,0px));background:linear-gradient(to top,var(--bg) 60%,transparent);pointer-events:none;}
.sticky-inner{max-width:480px;margin:0 auto;pointer-events:all;}
.sticky-btn{width:100%;padding:14px;border-radius:var(--r);background:var(--text);color:var(--bg);font-family:var(--font-body);font-size:.84rem;font-weight:800;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:7px;box-shadow:var(--shadow-lg);transition:opacity .15s;-webkit-tap-highlight-color:transparent;}
.sticky-btn:active{opacity:.83;}
@keyframes ctaPulse{0%,100%{box-shadow:0 0 0 0 rgba(87,169,120,.12);}50%{box-shadow:0 0 0 6px rgba(87,169,120,.20);}}
@keyframes fadeUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.fu{animation:fadeUp .3s ease both;}
.fu1{animation-delay:.04s;}
.fu2{animation-delay:.08s;}
.fu3{animation-delay:.12s;}

body.aod-mode{overflow:auto;}
body.aod-mode .topbar{border-bottom-color:var(--border);background:var(--bg);}
body.aod-mode .main{padding-top:8px;padding-bottom:0;min-height:calc(100vh - env(safe-area-inset-top,0px));}
body.aod-mode .tabs-wrap,body.aod-mode #scheduleArea,body.aod-mode #noticesWrap,body.aod-mode .fitir-card,body.aod-mode .gratitude-card,body.aod-mode .app-footer,body.aod-mode .sticky-footer{display:none !important;}
body.aod-mode .hero-grid{grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;}
body.aod-mode .hero-card{min-height:clamp(170px,33vh,360px);padding:16px 14px;border-width:2px;}
body.aod-mode .card-type{font-size:1.05rem;}
body.aod-mode .card-time{font-size:clamp(2.4rem,7.6vw,5.4rem);line-height:.93;}
body.aod-mode .card-name{font-size:1.08rem;}
body.aod-mode .card-tap-hint{font-size:.8rem;opacity:.65;}
body.aod-mode .day-nav{margin-bottom:8px;padding:14px 16px;border-radius:18px;border:1px solid var(--border);background:var(--surface);}
body.aod-mode .day-nav .nav-center{width:100%;text-align:center;}
body.aod-mode .day-nav .nav-meta{width:100%;}
body.aod-mode .day-nav .nav-time-wrap,body.aod-mode .day-nav .nav-today-chip,body.aod-mode .day-nav .nav-arrow{display:none !important;}
body.aod-mode .nav-date-main{font-size:clamp(1.35rem,3.3vw,2rem);font-weight:900;}
body.aod-mode .nav-ramadan-day{font-size:clamp(1rem,2.4vw,1.3rem);font-weight:800;margin-bottom:10px;text-align:center;background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:10px 12px;}
body.aod-mode .nav-clock-main{font-size:2rem;}
body.aod-mode .nav-clock-sec{font-size:1rem;}
body.aod-mode .progress-bar{padding:13px 13px;border-radius:16px;border-color:var(--border);background:var(--surface);}
body.aod-mode .progress-label,body.aod-mode .progress-countdown{font-size:1.05rem;}
body.aod-mode .progress-track{height:14px;}
body.aod-mode .topbar-inner{max-width:620px;}
body.aod-mode .icon-btn{width:40px;height:40px;font-size:18px;}
body.aod-mode .hero-card.aod-current{background:var(--surface);border-color:var(--border);}
body.aod-mode .hero-card.aod-current .card-type{color:var(--text2);}
body.aod-mode .hero-card.aod-current .card-time{color:var(--text);}
body.aod-mode .aod-clock-main{font-family:'Smooch Sans',var(--font-body);font-size:clamp(4.2rem,14vw,9rem);line-height:.82;font-weight:800;letter-spacing:-.03em;color:var(--text);display:inline-block;}
body.aod-mode .aod-clock-sec{font-family:'Smooch Sans',var(--font-body);font-size:clamp(1.5rem,3.8vw,2.8rem);line-height:1;font-weight:700;opacity:.68;margin-left:6px;vertical-align:baseline;color:var(--text2);}

@media (orientation: landscape){
  body.aod-mode .main{max-width:min(980px,96vw);margin:0 auto;padding:10px 14px 12px;}
  body.aod-mode .topbar-inner{max-width:min(980px,96vw);}
  body.aod-mode .day-nav{display:flex;align-items:center;justify-content:center;gap:10px;}
  body.aod-mode .hero-card{min-height:clamp(170px,38vh,360px);}
  body.aod-mode .status-grid{display:grid;grid-template-columns:minmax(0,1fr);}
}
@media (orientation: landscape) and (max-height: 500px){
  body.aod-mode .main{padding-top:6px;padding-bottom:6px;}
  body.aod-mode .day-nav{padding:10px 12px;margin-bottom:6px;}
  body.aod-mode .nav-date-main{font-size:clamp(1.1rem,2.8vw,1.4rem);}
  body.aod-mode .nav-ramadan-day{font-size:.95rem;padding:7px 10px;margin-bottom:6px;}
  body.aod-mode .hero-grid{gap:8px;margin-bottom:7px;}
  body.aod-mode .hero-card{min-height:clamp(145px,33vh,220px);padding:12px 12px;}
  body.aod-mode .card-type{font-size:.95rem;}
  body.aod-mode .card-name{font-size:.9rem;}
  body.aod-mode .card-tap-hint{font-size:.72rem;}
  body.aod-mode .aod-clock-main{font-size:clamp(3rem,11vw,5.2rem);}
  body.aod-mode .aod-clock-sec{font-size:clamp(1rem,3.3vw,1.8rem);}
  body.aod-mode .progress-bar{padding:10px 11px;}
  body.aod-mode .progress-label,body.aod-mode .progress-countdown{font-size:.92rem;}
  body.aod-mode .progress-track{height:10px;}
}
</style>
</head>
<body>

<div class="topbar">
  <div class="topbar-inner">
    <div class="brand">–†–∞–º–∞–¥–∞–Ω <em>1447</em><small>–†–∞–º–∞–∑–∞–Ω –ê–π—ã ¬∑ –ö—Ä—ã–º</small></div>
    <div class="topbar-actions">
      <button class="city-btn" id="cityBtn"><span class="city-dot"></span><span id="cityLabel">–°–∏–º—Ñ–µ—Ä–æ–ø–æ–ª—å</span><span style="font-size:.55rem;opacity:.4;margin-left:2px;">‚ñæ</span></button>
      <button class="icon-btn" id="aodBtn" title="–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º" aria-pressed="false">‚§¢</button>
      <button class="icon-btn" id="settingsBtn" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">‚öôÔ∏è</button>
    </div>
  </div>
</div>

<div class="main">
  <div class="install-banner fu" id="installBanner" style="display:none;">
    <div class="ib-icon">üì≤</div>
    <div class="ib-text"><div class="ib-title">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞ —ç–∫—Ä–∞–Ω</div><div class="ib-sub">–†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞</div></div>
    <button class="ib-close" id="installBannerClose">‚úï</button>
  </div>

  <div class="notice fu" id="landscapeFeatureNotice" style="display:none;margin-bottom:10px;">
    <span class="notice-ico">üÜï</span>
    <div>
      <div class="notice-title">–ù–æ–≤—ã–π –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º</div>
      <div class="notice-body">–ù–∞–∂–º–∏—Ç–µ <strong>‚§¢</strong>, —á—Ç–æ–±—ã —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å —ç–∫—Ä–∞–Ω –≤ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ. –≠—Ç–æ —É–¥–æ–±–Ω–æ –≤ –¥–æ—Ä–æ–≥–µ, –Ω–∞ –∫—É—Ö–Ω–µ –∏ –≤–æ –≤—Ä–µ–º—è –Ω–∞–º–∞–∑–∞, –∫–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –∫—Ä—É–ø–Ω—ã–π —Ç–∞–π–º–µ—Ä –±–µ–∑ –ª–∏—à–Ω–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.</div>
      <button class="cal-btn" id="landscapeFeatureNoticeBtn" style="margin-top:8px;padding:9px 12px;font-size:.72rem;">–ü–æ–Ω—è—Ç–Ω–æ</button>
    </div>
  </div>

  <div class="notice fu" id="newPostsNotice" style="display:none;margin-bottom:10px;">
    <span class="notice-ico">üì∞</span>
    <div>
      <div class="notice-title" id="newPostsNoticeTitle">–í—ã—à–ª–∏ –Ω–æ–≤—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</div>
      <div class="notice-body" id="newPostsNoticeBody">–í —Ä–∞–∑–¥–µ–ª–µ ¬´–ü–æ–∑–Ω–∞–≤–∞—Ç–µ–ª—å–Ω–æ¬ª –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω—ã –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã.</div>
      <div style="display:flex;gap:8px;margin-top:8px;flex-wrap:wrap;">
        <a class="support-link" href="materials.html" id="newPostsNoticeOpen">–û—Ç–∫—Ä—ã—Ç—å –ø–æ—Å—Ç—ã</a>
        <button class="cal-btn" id="newPostsNoticeDismiss" style="margin:0;padding:8px 12px;font-size:.72rem;">–°–∫—Ä—ã—Ç—å</button>
      </div>
    </div>
  </div>

  <div class="tabs-wrap fu tabs-wrap-top">
    <button class="tab active" data-mode="day" id="tabDay">–°–µ–≥–æ–¥–Ω—è</button>
    <button class="tab" data-mode="week">–ù–µ–¥–µ–ª—è</button>
    <button class="tab" data-mode="month">–ú–µ—Å—è—Ü</button>
  </div>

  <div id="daySectionWrap">
    <div class="day-nav fu">
      <button class="nav-arrow" id="prevDay">‚Äπ</button>
      <div class="nav-center">
        <div class="nav-meta">
          <span class="nav-today-chip" id="navTodayChip">–°–µ–≥–æ–¥–Ω—è</span>
          <div class="nav-date-main" id="navDateMain">‚Äî</div>
          <div class="nav-date-sub" id="navDateSub">‚Äî</div>
        </div>
        <div class="nav-time-wrap">
          <div class="nav-clock" aria-live="polite">
            <span class="nav-clock-part nav-clock-main" id="navClockHours">--</span><span class="nav-clock-colon">:</span><span class="nav-clock-part nav-clock-main" id="navClockMinutes">--</span><span class="nav-clock-colon">:</span><span class="nav-clock-part nav-clock-sec" id="navCurrentSeconds">--</span>
          </div>
        </div>
      </div>
      <button class="nav-arrow" id="nextDay">‚Ä∫</button>
    </div>
    <div class="nav-ramadan-day" id="navRamadanDay">‚Äî</div>
    <div class="hero-grid">
      <div class="hero-card imsak-card fu fu1" id="imsakCard">
        <div class="card-type">–ò–º—Å–∞–∫</div>
        <div class="card-time" id="heroImsakTime">‚Äî</div>
        <div class="card-name">–ù–∞—á–∞–ª–æ –ø–æ—Å—Ç–∞</div>
        <div class="card-tap-hint">–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –ø—Ä–æ—á–∏—Ç–∞—Ç—å –¥—É–∞</div>
      </div>
      <div class="hero-card iftar-card fu fu2" id="iftarCard">
        <div class="card-type">–ò—Ñ—Ç–∞—Ä</div>
        <div class="card-time" id="heroIftarTime">‚Äî</div>
        <div class="card-name">–†–∞–∑–≥–æ–≤–µ–Ω–∏–µ</div>
        <div class="card-tap-hint">–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –ø—Ä–æ—á–∏—Ç–∞—Ç—å –¥—É–∞</div>
      </div>
    </div>
    <div class="status-grid">
      <div class="progress-bar fu fu3" id="progressBar">
        <div class="progress-top">
          <div class="progress-label" id="progLabel"><span class="live-dot" style="color:var(--iftar)"></span><span id="progText">–ó–∞–≥—Ä—É–∑–∫–∞...</span></div>
          <div class="progress-countdown" id="progCountdown">‚Äî</div>
        </div>
        <div class="progress-track"><div class="progress-fill" id="progFill" style="width:0%"></div></div>
      </div>
      <a class="useful-tile fu fu3" href="materials.html" aria-label="–ü–æ–∑–Ω–∞–≤–∞—Ç–µ–ª—å–Ω–æ">
        <span class="useful-badge" id="materialsUnreadBadge">0</span>
        <div class="useful-eyebrow">–ü–æ–∑–Ω–∞–≤–∞—Ç–µ–ª—å–Ω–æ</div>
        
        <div class="useful-hint">–ß–∏—Ç–∞—Ç—å ‚Üí</div>
      </a>
    </div>
  </div>
<div class="gratitude-card fu fu3">
    <div class="gratitude-main">
      <div class="gratitude-copy">
        <div class="gratitude-eyebrow">–ü–æ–¥–¥–µ—Ä–∂–∞–ª–∏ –ø—Ä–æ–µ–∫—Ç 18 —á–µ–ª–æ–≤–µ–∫ –∏–∑ 1130 –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π</div>
        <div class="gratitude-sub">–ï—Å–ª–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç –≤–∞–º –∫–∞–∂–¥—ã–π –¥–µ–Ω—å ‚Äî –ø–æ–±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç–µ –∞–≤—Ç–æ—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</div>
      </div>
      <a href="https://pay.cloudtips.ru/p/8a27e9ab" target="_blank" rel="noopener" class="gratitude-cta">–ü–æ–±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç—å</a>
    </div>
  </div>
  
  <div id="scheduleArea"></div>

  <div id="noticesWrap">
    <div class="notice laylat fu fu1"><span class="notice-ico">üåô</span><div><div class="notice-title">–ù–æ—á—å –õ—è–π–ª—è—Ç—É–ª—å-–ö–∞–¥—Ä</div><div class="notice-body">16‚Äì17 –ú–∞—Ä—Ç ¬∑ –ö—ä–∞–¥–∏—Ä –≥–µ–¥–∂–µ—Å–∏.
      <p></p>–í –∏—Å–ª–∞–º–µ ‚Äî –ø–æ—á–∏—Ç–∞–µ–º–∞—è –Ω–æ—á—å –º–µ—Å—è—Ü–∞ –ø–æ—Å—Ç–∞ –†–∞–º–∞–¥–∞–Ω, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –Ω–∏—Å–ø–æ—Å–ª–∞–Ω–∏–µ–º –ø—Ä–æ—Ä–æ–∫—É –ú—É—Ö–∞–º–º–µ–¥—É –ö–æ—Ä–∞–Ω–∞ –≤ –≤–∏–¥–µ –æ—Ç–∫—Ä–æ–≤–µ–Ω–∏—è –≤ –ø–µ—â–µ—Ä–µ –•–∏—Ä–∞ –≥–æ—Ä—ã –î–∂–∞–±–∞–ª—å –∞–ª—å-–ù—É—Ä
    </p>
    </div></div></div>
    <div class="notice bayram fu fu2"><span class="notice-ico">üéâ</span><div><div class="notice-title">–ú–∞—Ä—Ç 20, 21, 22 ‚Äî –û—Ä–∞–∑–∞ –ë–∞–π—Ä–∞–º—ã</div><div class="notice-body">–û—Ä–∞–∑–∞ –±–∞–π—Ä–∞–º –Ω–∞–º–∞–∑—ã –º–∞—Ä—Ç 20, —Å–∞–∞—Ç <strong>7:30</strong> –∫—ä—ã–ª—ã–Ω–∞–¥–∂–∞–∫—ä</div></div></div>
  </div>

  

  <div class="fitir-card fu fu3" id="fitirCard" aria-label="–ó–∞–∫—è—Ç –≤ –ò—Å–ª–∞–º–µ">
    <div class="fitir-header">
      <div class="fitir-ico">ü§≤</div>
      <div>
        <div class="fitir-title">–§–∏—Ç–∏—Ä –°–∞–¥–∞–∫—ä–∞—Å—ã
          <small>–ó–∞–∫—è—Ç –∞–ª—å-–§–∏—Ç—Ä ¬∑ –ó–µ–∫—è—Ç</small>
        </div>
      </div>
    </div>
    <div class="fitir-body">
      –ö—ä—Ä—ã–º –º—É—Å—É–ª—å–º–∞–Ω–ª–∞—Ä—ã –¥–∏–Ω–∏–π –∏–¥–∞—Ä–µ—Å–∏ –±—É –π—ã–ª —Ñ–∏—Ç–∏—Ä —Å–∞–¥–∞–∫—ä–∞—Å—ã–Ω—ã–Ω—ä –º–∏–∫—ä–¥–∞—Ä—ã–Ω—ã –±–∏—Ä –∞–¥–∞–º –∏—á—é–Ω —ç–Ω—ä –∞–∑—ã –±–µ–ª–≥–∏–ª–µ–¥–∏.<br><br>
      –í—ã–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –¥–æ –Ω–∞–º–∞–∑–∞ –û—Ä–∞–∑–∞ –±–∞–π—Ä–∞–º—ã ‚Äî –¥–æ <strong>20 –º–∞—Ä—Ç–∞</strong>.
      <div style="margin-top:10px;display:flex;align-items:center;gap:10px;flex-wrap:wrap;">
        <a class="fitir-amount" id="fitirAmountLink" href="zakat.html?entry=fitir-amount" aria-label="–ó–∞–∫—è—Ç –≤ –ò—Å–ª–∞–º–µ">500 ‚ÇΩ / —á–µ–ª.</a>
        <span style="font-size:.72rem;font-weight:600;color:var(--text3);">–Ω–∞ –∫–∞–∂–¥–æ–≥–æ —á–ª–µ–Ω–∞ —Å–µ–º—å–∏</span>
      </div>
    </div>
  </a>

</div>

</div><!-- end main -->

<!-- FOOTER -->
<div class="app-footer">
  <div class="footer-inner">
    <div class="footer-made">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ò–º—Å–∞–∫ –∏ –ò—Ñ—Ç–∞—Ä –¥–ª—è –º—É—Å—É–ª—å–º–∞–Ω –ö—Ä—ã–º–∞.<br><em style="color:var(--gold);">–†–∞–º–∞–¥–∞–Ω –ú—É–±–∞—Ä–∞–∫!</em></div>
    <div class="footer-tg">Telegram: <a href="https://t.me/EnrikeTomas" target="_blank">@EnrikeTomas</a></div>
  </div>
</div>

<div class="sticky-footer"><div class="sticky-inner"><div class="bottom-actions"><button class="bottom-btn bottom-btn-primary" id="calBtn">üìÖ –í –∫–∞–ª–µ–Ω–¥–∞—Ä—å</button><button class="bottom-btn" id="shareBottomBtn">üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button></div></div></div>

<!-- CITY SHEET -->
<div class="overlay" id="citySheet"><div class="sheet"><div class="sheet-pull"><div class="sheet-handle"></div></div><div class="sheet-title">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥</div><div class="sheet-sub">–í—Ä–µ–º—è —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</div><div class="city-list" id="cityList"></div></div></div>

<!-- PRAYER SHEET -->
<div class="overlay" id="prayerSheet"><div class="sheet"><div class="sheet-pull"><div class="sheet-handle"></div></div><div id="prayerContent"></div><button class="cal-btn" style="margin-top:18px;" onclick="closeSheet('prayerSheet')">–ó–∞–∫—Ä—ã—Ç—å</button></div></div>

<!-- CAL SHEET -->
<div class="overlay" id="calSheet"><div class="sheet"><div class="sheet-pull"><div class="sheet-handle"></div></div><div class="sheet-title">üìÖ –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä—å</div><div class="sheet-sub">–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–µ –Ω—É–∂–Ω–∞</div><button class="cal-btn cal-btn-primary" id="icsBtn">üì• –°–∫–∞—á–∞—Ç—å .ics (Apple ¬∑ Outlook ¬∑ –Ø–Ω–¥–µ–∫—Å)</button><button class="cal-btn" id="googleBtn"><svg width="15" height="15" viewBox="0 0 48 48"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"/><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"/><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.18 1.48-4.97 2.36-8.16 2.36-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"/></svg>Google –ö–∞–ª–µ–Ω–¥–∞—Ä—å</button><div class="cal-hint">üí° <strong>.ics —Ñ–∞–π–ª</strong> ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è Apple Calendar, Google, Outlook. –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª ‚Üí –æ–Ω —Å–∞–º –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –¥–æ–±–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏—è.</div><button class="cal-btn" style="margin-top:10px;" onclick="closeSheet('calSheet')">–û—Ç–º–µ–Ω–∞</button></div></div>


<!-- SETTINGS SHEET -->
<div class="overlay" id="settingsSheet"><div class="sheet"><div class="sheet-pull"><div class="sheet-handle"></div></div><div class="sheet-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div><div class="sheet-sub">–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å</div>

<div class="settings-group"><div class="settings-group-title">–£—Å—Ç–∞–Ω–æ–≤–∫–∞</div><div class="settings-item" style="cursor:pointer;" onclick="openSheet('installSheet')"><div><div class="si-label">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞ —ç–∫—Ä–∞–Ω</div><div class="si-sub">–†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</div></div><span style="font-size:.9rem;color:var(--text3);">‚Ä∫</span></div></div>
<div class="settings-group"><div class="settings-group-title">–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å</div><div class="settings-item"><div><div class="si-label">–¢–µ–º–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</div><div class="si-sub" id="themeLabel">–°–≤–µ—Ç–ª–∞—è</div></div><button class="icon-btn" id="themeBtn" title="–°–≤–µ—Ç–ª–∞—è/—Ç—ë–º–Ω–∞—è —Ç–µ–º–∞">üåô</button></div></div>
<div class="settings-group"><div class="settings-group-title">–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</div><div class="settings-item" style="flex-direction:column;align-items:flex-start;gap:6px;"><div class="si-label">–†–∞–º–∞–¥–∞–Ω 1447 ¬∑ –ö—Ä—ã–º</div><div class="si-sub" style="line-height:1.6;">–≠—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –∏ –∑–∞–±–æ—Ç–æ–π –¥–ª—è –∫—Ä—ã–º—Å–∫–∏—Ö –º—É—Å—É–ª—å–º–∞–Ω. –ü—É—Å—Ç—å –≤–∞—à –ø–æ—Å—Ç –±—É–¥–µ—Ç –ø—Ä–∏–Ω—è—Ç, –∞ –¥—É–∞ —É—Å–ª—ã—à–∞–Ω—ã. –†–∞–º–∞–¥–∞–Ω –ú—É–±–∞—Ä–∞–∫! ü§≤</div><a href="https://t.me/EnrikeTomas" target="_blank" style="display:inline-flex;align-items:center;gap:6px;font-size:.78rem;font-weight:800;color:var(--gold);text-decoration:none;">‚úâÔ∏è Enver Isliamov ¬∑ @EnrikeTomas</a><a href="https://pay.cloudtips.ru/p/8a27e9ab" target="_blank" rel="noopener" class="support-link">‚òï –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</a><div class="si-sub">–í–µ—Ä—Å–∏—è 3.0 ¬∑ PWA</div></div></div>
<button class="cal-btn" onclick="closeSheet('settingsSheet')">–ó–∞–∫—Ä—ã—Ç—å</button></div></div>

<!-- INSTALL SHEET -->
<div class="overlay" id="installSheet"><div class="sheet"><div class="sheet-pull"><div class="sheet-handle"></div></div><div class="sheet-title">üì≤ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</div><div class="sheet-sub">–†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏</div>
<div class="install-guide"><div class="ig-title">üì± iPhone / iPad (Safari)</div><div class="ig-body">1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É <strong>–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</strong> (–∫–≤–∞–¥—Ä–∞—Ç —Å–æ —Å—Ç—Ä–µ–ª–∫–æ–π –≤–≤–µ—Ä—Ö)<br>2. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ ‚Üí <strong>¬´–ù–∞ —ç–∫—Ä–∞–Ω –î–æ–º–æ–π¬ª</strong><br>3. –ù–∞–∂–º–∏—Ç–µ <strong>¬´–î–æ–±–∞–≤–∏—Ç—å¬ª</strong></div></div>
<div class="install-guide"><div class="ig-title">ü§ñ Android (Chrome)</div><div class="ig-body">1. –ù–∞–∂–º–∏—Ç–µ <strong>‚ãÆ</strong> (—Ç—Ä–∏ —Ç–æ—á–∫–∏) —Å–ø—Ä–∞–≤–∞ –≤–≤–µ—Ä—Ö—É<br>2. –í—ã–±–µ—Ä–∏—Ç–µ <strong>¬´–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω¬ª</strong><br>3. –ù–∞–∂–º–∏—Ç–µ <strong>¬´–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å¬ª</strong></div></div>
<div id="androidInstallBtn" style="display:none;margin-bottom:8px;"><button class="cal-btn cal-btn-primary" id="promptInstallBtn">üì≤ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ–π—á–∞—Å</button></div>
<button class="cal-btn" onclick="closeSheet('installSheet')">–ü–æ–Ω—è—Ç–Ω–æ</button></div></div>

<!-- SHARE SHEET -->
<div class="overlay" id="shareSheet"><div class="sheet"><div class="sheet-pull"><div class="sheet-handle"></div></div><div class="sheet-title">üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è</div><div class="sheet-sub">–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥—Ä—É–∑—å—è–º</div>
<div class="share-list">
  <div class="share-item" id="shareNative" style="display:none;background:linear-gradient(135deg,var(--gold-soft),rgba(196,154,60,.04));border-color:rgba(196,154,60,.25);">
    <div class="share-ico">üì§</div><div><div class="share-name">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è...</div><div class="share-desc">–ß–µ—Ä–µ–∑ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã, —Å–æ—Ü—Å–µ—Ç–∏ –∏ –¥—Ä—É–≥–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</div></div>
  </div>
  <div class="share-divider" id="shareDivider" style="display:none;">‚Äî –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ ‚Äî</div>
  <div class="share-item" id="shareWhatsapp"><div class="share-ico">üí¨</div><div><div class="share-name">WhatsApp</div><div class="share-desc">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ WhatsApp</div></div></div>
  <div class="share-item" id="shareTelegram"><div class="share-ico">‚úàÔ∏è</div><div><div class="share-name">Telegram</div><div class="share-desc">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Telegram</div></div></div>
  <div class="share-item" id="shareViber"><div class="share-ico">üì≥</div><div><div class="share-name">Viber</div><div class="share-desc">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Viber</div></div></div>
  <div class="share-item" id="shareVK"><div class="share-ico">üîµ</div><div><div class="share-name">–í–ö–æ–Ω—Ç–∞–∫—Ç–µ</div><div class="share-desc">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –í–ö–æ–Ω—Ç–∞–∫—Ç–µ</div></div></div>
  <div class="share-item" id="shareCopy"><div class="share-ico">üîó</div><div><div class="share-name" id="shareCopyLabel">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</div><div class="share-desc">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</div></div></div>
</div>
<button class="cal-btn" style="margin-top:14px;" onclick="closeSheet('shareSheet')">–û—Ç–º–µ–Ω–∞</button>
</div></div>

<script src="content-release.js"></script>
<script>
const DATA=[[1,19,2,'6:11','18:27'],[2,20,2,'6:10','18:28'],[3,21,2,'6:08','18:30'],[4,22,2,'6:07','18:31'],[5,23,2,'6:05','18:32'],[6,24,2,'6:04','18:34'],[7,25,2,'6:02','18:35'],[8,26,2,'6:00','18:36'],[9,27,2,'5:59','18:38'],[10,28,2,'5:57','18:39'],[11,1,3,'5:55','18:40'],[12,2,3,'5:53','18:42'],[13,3,3,'5:52','18:43'],[14,4,3,'5:50','18:45'],[15,5,3,'5:48','18:46'],[16,6,3,'5:46','18:47'],[17,7,3,'5:44','18:48'],[18,8,3,'5:43','18:50'],[19,9,3,'5:41','18:51'],[20,10,3,'5:39','18:52'],[21,11,3,'5:37','18:54'],[22,12,3,'5:35','18:55'],[23,13,3,'5:33','18:56'],[24,14,3,'5:31','18:58'],[25,15,3,'5:29','18:59'],[26,16,3,'5:27','19:00'],[27,17,3,'5:25','19:01'],[28,18,3,'5:23','19:03'],[29,19,3,'5:21','19:04']];
const CITIES=[{name:'–ê–∫—ä–º–µ—Å–¥–∂–∏—Ç (–°–∏–º—Ñ–µ—Ä–æ–ø–æ–ª—å)',short:'–°–∏–º—Ñ.',offset:0},{name:'–ê–ª—É—à—Ç–∞',short:'–ê–ª—É—à—Ç–∞',offset:-1},{name:'–ë–∞—Ö—á–∏—Å–∞—Ä–∞–π',short:'–ë–∞—Ö—á.',offset:2},{name:'–ö—ä–∞—Ä–∞—Å—É–≤–±–∞–∑–∞—Ä (–ë–µ–ª–æ–≥–æ—Ä—Å–∫)',short:'–ë–µ–ª–æ–≥.',offset:-2},{name:'–î–∂–∞–Ω–∫–æ–π',short:'–î–∂–∞–Ω–∫–æ–π',offset:-1},{name:'–ö–µ–∑–ª–µ–≤ (–ï–≤–ø–∞—Ç–æ—Ä–∏—è)',short:'–ö–µ–∑–ª–µ–≤',offset:3},{name:'–ö–µ—Ä—á—å',short:'–ö–µ—Ä–∏—á (–ö–µ—Ä—á—å)',offset:-9},{name:'–≠—Å–∫–∏ –ö—ä—ã—Ä—ã–º (–°—Ç–∞—Ä—ã–π –ö—Ä—ã–º)',short:'–°—Ç.–ö—Ä—ã–º',offset:-3},{name:'–ö–µ—Ñ–µ (–§–µ–æ–¥–æ—Å–∏—è)',short:'–ö–µ—Ñ–µ'	,offset:-5},{name:'–Ø–ª—Ç–∞',short:'–Ø–ª—Ç–∞',offset:4},{name:'–û—Ä –ö–∞–ø—ã (–ü–µ—Ä–µ–∫–æ–ø)',short:'–û—Ä –ö–∞–ø—ã',offset:2},{name:'–ê–∫—ä—è—Ä (–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å)',short:'–ê–∫—ä—è—Ä',offset:2},{name:'–ê–∫—ä—à–µ–π—Ö (–†–∞–∑–¥–æ–ª—å–Ω–æ–µ)',short:'–ê–∫—ä—à–µ–π—Ö',offset:3},{name:'–ê–∫—ä–º–µ—á–∏—Ç (–ß–µ—Ä–Ω–æ–º–æ—Ä—Å–∫–æ–µ)',short:'–ê–∫—ä–º–µ—á–∏—Ç',offset:4},{name:'–°—É–¥–∞–∫—ä',short:'–°—É–¥–∞–∫—ä',offset:-3}];
const DAYS=['–í—Å','–ü–Ω','–í—Ç','–°—Ä','–ß—Ç','–ü—Ç','–°–±'];
const MS=['','–Ø–Ω–≤','–§–µ–≤','–ú–∞—Ä','–ê–ø—Ä','–ú–∞–π','–ò—é–Ω','–ò—é–ª','–ê–≤–≥','–°–µ–Ω','–û–∫—Ç','–ù–æ—è','–î–µ–∫'];
const MF=['','–Ø–Ω–≤–∞—Ä—å','–§–µ–≤—Ä–∞–ª—å','–ú–∞—Ä—Ç','–ê–ø—Ä–µ–ª—å','–ú–∞–π','–ò—é–Ω—å','–ò—é–ª—å','–ê–≤–≥—É—Å—Ç','–°–µ–Ω—Ç—è–±—Ä—å','–û–∫—Ç—è–±—Ä—å','–ù–æ—è–±—Ä—å','–î–µ–∫–∞–±—Ä—å'];
const PRAYERS={
  imsak:{badge:'üåô –ú–æ–ª–∏—Ç–≤–∞ –ò–º—Å–∞–∫',translit:'–ù–∞–≤–∞–π—Ç—É –∞–Ω-–∞—Å—É—É–º–∞ —Å–∞—É–º–∞ —à–∞—Ö—Ä–∏ —Ä–∞–º–∞–¥–∞–∞–Ω –º–∏–Ω–∞–ª—å-—Ñ–∞–¥–∂—Ä–∏ –∏–ª—è–ª—å-–º–∞–≥—Ä–∏–±–∏ —Ö–∞–∞–ª–∏—Å–∞–Ω –ª–∏–ª–ª—è—è—Ö–∏ —Ç–∞‚Äô–∞–ª—è',arabic:'ŸÜŸéŸàŸéŸäŸíÿ™Ÿè ÿ£ŸéŸÜŸí ÿ£ŸéÿµŸèŸàŸÖŸé ÿµŸéŸàŸíŸÖŸé ÿ¥ŸéŸáŸíÿ±Ÿê ÿ±ŸéŸÖŸéÿ∂ŸéÿßŸÜŸé ŸÖŸêŸÜŸé ÿßŸÑŸíŸÅŸéÿ¨Ÿíÿ±Ÿê ÿ•ŸêŸÑŸéŸâ ÿßŸÑŸíŸÖŸéÿ∫Ÿíÿ±Ÿêÿ®Ÿê ÿÆŸéÿßŸÑŸêÿµŸãÿß ŸÑŸêŸÑŸéŸëŸáŸê ÿ™ŸéÿπŸéÿßŸÑŸéŸâ',text:'¬´–Ø –Ω–∞–º–µ—Ä–µ–≤–∞—é—Å—å –¥–µ—Ä–∂–∞—Ç—å –ø–æ—Å—Ç –º–µ—Å—è—Ü–∞ –†–∞–º–∞–¥–∞–Ω –æ—Ç —Ä–∞—Å—Å–≤–µ—Ç–∞ –¥–æ –∑–∞–∫–∞—Ç–∞, –∏—Å–∫—Ä–µ–Ω–Ω–µ —Ä–∞–¥–∏ –ê–ª–ª–∞—Ö–∞ –í—Å–µ–≤—ã—à–Ω–µ–≥–æ¬ª',placeholder:true},
  iftar:{badge:'üåø –ú–æ–ª–∏—Ç–≤–∞ –ò—Ñ—Ç–∞—Ä',translit:'–ê–ª–ª–∞—Ö—É–º–º–º–µ –ª–µ–∫–µ —Å—É–º—Ç—É –≤–µ –±–∏–∫–µ –∞–º–µ–Ω—Ç—É –≤–µ –∞–ª–µ–π–∫–µ —Ç–µ–≤–µ–∫–∫–µ–ª—å—Ç—É –≤–µ –∞–ª—è —Ä–∏–∑–∫—ä–∏–∫–µ —ç—Ñ—Ç–∞—Ä—Ç—É –≤–µ —Å–∞–≤–º–∏‚Äô–ª—å-–≥—ä–∞–¥–∏ –º–∏–Ω —à–µ—Ö—Ä–∏ —Ä–∞–º–∞–¥–∞–Ω–µ –Ω–µ–≤–µ–π—Ç—É. –§–µ–≥—ä—Ñ–∏—Ä–ª–∏ –º–∞ –∫—ä–∞–¥–¥–µ–º—Ç—É –≤–µ –º–∞ –∞—Ö—Ö–∞—Ä—Ç—É',arabic:'ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ŸÑŸéŸÉŸé ÿµŸèŸÖŸíÿ™Ÿè ŸàŸéÿπŸéŸÑŸéŸâ ÿ±Ÿêÿ≤ŸíŸÇŸêŸÉŸé ÿ£ŸéŸÅŸíÿ∑Ÿéÿ±Ÿíÿ™Ÿè',text:'¬´–û –ê–ª–ª–∞—Ö, —Ä–∞–¥–∏ –¢–µ–±—è —è –ø–æ—Å—Ç–∏–ª—Å—è –∏ –¢–≤–æ–∏–º —É–¥–µ–ª–æ–º —Ä–∞–∑–≥–æ–≤–ª—è—é—Å—å¬ª',placeholder:true}
};
let cityIdx=parseInt(localStorage.getItem('ramCity')||'0');if(cityIdx>=CITIES.length)cityIdx=0;
let viewIdx=0,mode='day',weekOff=0,installPrompt=null;
const $=id=>document.getElementById(id);
function toMin(t){const[h,m]=t.split(':').map(Number);return h*60+m;}
function shiftTime(t,off){let m=toMin(t)+off;m=((m%1440)+1440)%1440;return`${Math.floor(m/60)}:${String(m%60).padStart(2,'0')}`;}
function adj(row){const o=CITIES[cityIdx].offset;return{imsak:shiftTime(row[3],o),iftar:shiftTime(row[4],o)};}
function dateOf(row){return new Date(2026,row[2]-1,row[1]);}
function isToday(row){const n=new Date();return row[1]===n.getDate()&&row[2]===n.getMonth()+1;}
function isLaylat(row){return row[1]===16&&row[2]===3;}
function isLaylatNight(row){return(row[1]===16||row[1]===17)&&row[2]===3;}
function isBayram(row){return row[2]===3&&row[1]>=20&&row[1]<=22;}
function todayIdx(){const n=new Date();const i=DATA.findIndex(r=>r[1]===n.getDate()&&r[2]===n.getMonth()+1);return i>=0?i:0;}

// THEME
const th0=localStorage.getItem('ramTheme')||'light';
document.documentElement.setAttribute('data-theme',th0);
function applyTheme(){const t=document.documentElement.getAttribute('data-theme');$('themeBtn').textContent=t==='dark'?'‚òÄÔ∏è':'üåô';const tl=$('themeLabel');if(tl)tl.textContent=t==='dark'?'–¢—ë–º–Ω–∞—è':'–°–≤–µ—Ç–ª–∞—è';$('metaThemeColor').setAttribute('content',t==='dark'?'#100e0c':'#c49a3c');}
applyTheme();
$('themeBtn').onclick=()=>{const t=document.documentElement.getAttribute('data-theme')==='dark'?'light':'dark';document.documentElement.setAttribute('data-theme',t);localStorage.setItem('ramTheme',t);applyTheme();};

// FONT

// CITY
$('cityLabel').textContent=CITIES[cityIdx].name;
function buildCityList(){const list=$('cityList');list.innerHTML='';CITIES.forEach((c,i)=>{const s=c.offset>0?`+${c.offset}`:c.offset<0?`${c.offset}`:'¬±0';const el=document.createElement('div');el.className='city-item'+(i===cityIdx?' ci-active':'');el.innerHTML=`<div><div class="ci-name">${c.name}</div><div class="ci-offset">–†–∞–∑–Ω–∏—Ü–∞: ${s} –º–∏–Ω</div></div>${i===cityIdx?'<span class="ci-check">‚úì</span>':''}`;el.onclick=()=>{cityIdx=i;localStorage.setItem('ramCity',i);$('cityLabel').textContent=c.name;closeSheet('citySheet');renderAll();};list.appendChild(el);});}
$('cityBtn').onclick=()=>{buildCityList();openSheet('citySheet');};

// SHEETS
function openSheet(id){$(id).classList.add('open');document.body.style.overflow='hidden';}
function closeSheet(id){$(id).classList.remove('open');document.body.style.overflow='';}
document.querySelectorAll('.overlay').forEach(o=>{o.addEventListener('click',e=>{if(e.target===o){o.classList.remove('open');document.body.style.overflow='';}});});
$('settingsBtn').onclick=()=>{openSheet('settingsSheet');registerEngagement();if(userEngagementScore>=2)maybeSendSupportPush();};
$('calBtn').onclick=()=>openSheet('calSheet');


// ALWAYS ON DISPLAY
const AOD_KEY='ramAodEnabled';
const FEATURE_NOTICE_KEY='ramLandscapeFeatureSeen';
const POSTS_NOTICE_SEEN_KEY='ramPostsSeenCount';
let aodWakeLock=null;

function getAodPhase(imsakT,iftarT){
  const nowSec=new Date().getHours()*3600+new Date().getMinutes()*60+new Date().getSeconds();
  const imSec=toMin(imsakT)*60;
  const ifSec=toMin(iftarT)*60;
  if(nowSec<imSec)return 'night';
  if(nowSec<ifSec)return 'day';
  return 'after';
}

function updateAodPrimaryTiles(imsakT,iftarT){
  if(!document.body.classList.contains('aod-mode'))return;
  const phase=getAodPhase(imsakT,iftarT);
  const now=new Date();
  const hh=String(now.getHours()).padStart(2,'0');
  const mm=String(now.getMinutes()).padStart(2,'0');
  const ss=String(now.getSeconds()).padStart(2,'0');
  const imType=$('imsakCard')?.querySelector('.card-type');
  const imTime=$('heroImsakTime');
  const imName=$('imsakCard')?.querySelector('.card-name');
  const imHint=$('imsakCard')?.querySelector('.card-tap-hint');
  const ifType=$('iftarCard')?.querySelector('.card-type');
  const ifTime=$('heroIftarTime');
  const ifName=$('iftarCard')?.querySelector('.card-name');
  const ifHint=$('iftarCard')?.querySelector('.card-tap-hint');
  if(!imType||!imTime||!imName||!imHint||!ifType||!ifTime||!ifName||!ifHint)return;

  $('imsakCard')?.classList.add('aod-current');
  $('iftarCard')?.classList.remove('aod-current');

  imType.textContent='–°–ï–ô–ß–ê–°';
  imTime.innerHTML=`<span class="aod-clock-main">${hh}:${mm}</span><span class="aod-clock-sec">:${ss}</span>`;
  imName.textContent='–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è';
  imHint.textContent='–û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É';

  if(phase==='night'){
    ifType.textContent='–ò–ú–°–ê–ö';
    ifTime.textContent=imsakT;
    ifName.textContent='–ë–ª–∏–∂–∞–π—à–µ–µ —Å–æ–±—ã—Ç–∏–µ';
    ifHint.textContent='–ù–∞—á–∞–ª–æ –ø–æ—Å—Ç–∞';
    $('iftarCard')?.classList.add('imsak-card');
    $('iftarCard')?.classList.remove('iftar-card');
  }else{
    ifType.textContent='–ò–§–¢–ê–†';
    ifTime.textContent=iftarT;
    ifName.textContent=phase==='day'?'–ë–ª–∏–∂–∞–π—à–µ–µ —Å–æ–±—ã—Ç–∏–µ':'–°–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å';
    ifHint.textContent=phase==='day'?'–í—Ä–µ–º—è —Ä–∞–∑–≥–æ–≤–µ–Ω–∏—è':'–ò—Ñ—Ç–∞—Ä —É–∂–µ –Ω–∞—Å—Ç—É–ø–∏–ª';
    $('iftarCard')?.classList.add('iftar-card');
    $('iftarCard')?.classList.remove('imsak-card');
  }
}

function restoreDefaultTiles(imsakT,iftarT){
  const imType=$('imsakCard')?.querySelector('.card-type');
  const imName=$('imsakCard')?.querySelector('.card-name');
  const imHint=$('imsakCard')?.querySelector('.card-tap-hint');
  const ifType=$('iftarCard')?.querySelector('.card-type');
  const ifName=$('iftarCard')?.querySelector('.card-name');
  const ifHint=$('iftarCard')?.querySelector('.card-tap-hint');
  $('imsakCard')?.classList.remove('aod-current');
  $('iftarCard')?.classList.add('iftar-card');
  $('iftarCard')?.classList.remove('imsak-card');
  if(imType)imType.textContent='–ò–º—Å–∞–∫';
  if(ifType)ifType.textContent='–ò—Ñ—Ç–∞—Ä';
  if($('heroImsakTime'))$('heroImsakTime').textContent=imsakT;
  if($('heroIftarTime'))$('heroIftarTime').textContent=iftarT;
  if(imName)imName.textContent='–ù–∞—á–∞–ª–æ –ø–æ—Å—Ç–∞';
  if(ifName)ifName.textContent='–†–∞–∑–≥–æ–≤–µ–Ω–∏–µ';
  if(imHint)imHint.textContent='–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –ø—Ä–æ—á–∏—Ç–∞—Ç—å –¥—É–∞';
  if(ifHint)ifHint.textContent='–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –ø—Ä–æ—á–∏—Ç–∞—Ç—å –¥—É–∞';
}

async function syncWakeLock(){
  const active=document.body.classList.contains('aod-mode');
  if(!('wakeLock' in navigator))return;
  if(active && !document.hidden && !aodWakeLock){
    try{aodWakeLock=await navigator.wakeLock.request('screen');aodWakeLock.addEventListener('release',()=>{aodWakeLock=null;});}catch(e){}
  }
  if((!active||document.hidden) && aodWakeLock){
    try{await aodWakeLock.release();}catch(e){}
    aodWakeLock=null;
  }
}

function updateAodButton(){
  const btn=$('aodBtn');
  if(!btn)return;
  const manual=localStorage.getItem(AOD_KEY)==='1';
  const active=document.body.classList.contains('aod-mode');
  btn.classList.toggle('aod-active',active);
  btn.setAttribute('aria-pressed',String(manual));
  btn.textContent=active?'‚§°':'‚§¢';
  btn.title=active?'–í—ã–π—Ç–∏ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞':'–í–∫–ª—é—á–∏—Ç—å –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º';
}


async function syncFullscreen(){
  const manual=localStorage.getItem(AOD_KEY)==='1';
  if(manual && !document.fullscreenElement && document.documentElement.requestFullscreen){
    try{
      await document.documentElement.requestFullscreen({navigationUI:'hide'});
      if(screen.orientation&&screen.orientation.lock){
        try{await screen.orientation.lock('landscape');}catch(e){}
      }
    }catch(e){}
    return;
  }
  if(!manual && document.fullscreenElement && document.exitFullscreen){
    try{
      if(screen.orientation&&screen.orientation.unlock){screen.orientation.unlock();}
      await document.exitFullscreen();
    }catch(e){}
  }
}

function applyAodMode(){
  const manual=localStorage.getItem(AOD_KEY)==='1';
  const active=manual;
  document.body.classList.toggle('aod-mode',active);
  updateAodButton();
  syncWakeLock();
  syncFullscreen();
  const row=DATA[viewIdx]||DATA[todayIdx()];
  const t=adj(row);
  if(active){updateAodPrimaryTiles(t.imsak,t.iftar);}else{restoreDefaultTiles(t.imsak,t.iftar);}
}

$('aodBtn').onclick=()=>{
  const manual=localStorage.getItem(AOD_KEY)==='1';
  localStorage.setItem(AOD_KEY,manual?'0':'1');
  applyAodMode();
};

document.addEventListener('visibilitychange',syncWakeLock);
window.addEventListener('storage',e=>{if(e.key===AOD_KEY){applyAodMode();}});
document.addEventListener('fullscreenchange',updateAodButton);

// SHARE - bottom button
$('shareBottomBtn').onclick=()=>openSheet('shareSheet');
const SHARE_URL='https://enver-isliamov.github.io/oraza/';
const SHARE_TEXT='üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –†–∞–º–∞–¥–∞–Ω 1447 ‚Äî –ö—Ä—ã–º. –ò–º—Å–∞–∫, –ò—Ñ—Ç–∞—Ä, –û—Ä–∞–∑–∞ –ë–∞–π—Ä–∞–º—ã. –£–¥–æ–±–Ω–æ–µ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:';
function setupShare(){
  if(navigator.share){
    $('shareNative').style.display='flex';
    $('shareDivider').style.display='block';
  }
  $('shareNative').onclick=async()=>{
    try{await navigator.share({title:'–†–∞–º–∞–¥–∞–Ω 1447 ¬∑ –ö—Ä—ã–º',text:SHARE_TEXT,url:SHARE_URL});}catch(e){}
    closeSheet('shareSheet');
  };
  $('shareWhatsapp').onclick=()=>{window.open(`https://wa.me/?text=${encodeURIComponent(SHARE_TEXT+' '+SHARE_URL)}`,'_blank');closeSheet('shareSheet');};
  $('shareTelegram').onclick=()=>{window.open(`https://t.me/share/url?url=${encodeURIComponent(SHARE_URL)}&text=${encodeURIComponent(SHARE_TEXT)}`,'_blank');closeSheet('shareSheet');};
  $('shareViber').onclick=()=>{window.open(`viber://forward?text=${encodeURIComponent(SHARE_TEXT+' '+SHARE_URL)}`,'_blank');closeSheet('shareSheet');};
  $('shareVK').onclick=()=>{window.open(`https://vk.com/share.php?url=${encodeURIComponent(SHARE_URL)}&title=${encodeURIComponent(SHARE_TEXT)}`,'_blank');closeSheet('shareSheet');};
  $('shareCopy').onclick=()=>{
    const full=SHARE_TEXT+' '+SHARE_URL;
    if(navigator.clipboard){navigator.clipboard.writeText(full).then(()=>{$('shareCopyLabel').textContent='‚úì –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';setTimeout(()=>{$('shareCopyLabel').textContent='–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É';},2000);});}
    else{const t=document.createElement('textarea');t.value=full;document.body.appendChild(t);t.select();document.execCommand('copy');document.body.removeChild(t);$('shareCopyLabel').textContent='‚úì –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';setTimeout(()=>{$('shareCopyLabel').textContent='–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É';},2000);}
  };
}
setupShare();

// USER NOTIFICATIONS
const SUPPORT_PUSH_KEY='ramSupportPushSeen';
let userEngagementScore=0;
function registerEngagement(){userEngagementScore=Math.min(10,userEngagementScore+1);}
['click','scroll','touchstart'].forEach(evt=>window.addEventListener(evt,registerEngagement,{passive:true}));

function maybeSendSupportPush(){
  if(localStorage.getItem(SUPPORT_PUSH_KEY))return;
  if(!('Notification' in window))return;
  if(Notification.permission!=='granted')return;
  try{
    new Notification('–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –ø–æ–ª—å–∑—É–µ—Ç–µ—Å—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º', {body:'–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —É–∂–µ –ø–æ–º–æ–≥–∞–µ—Ç –º–Ω–æ–≥–∏–º. –ü—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∞–ª–∏ 18 —á–µ–ª–æ–≤–µ–∫ ‚Äî –≤—ã —Ç–æ–∂–µ –º–æ–∂–µ—Ç–µ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∏ –ø–æ–±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç—å –∞–≤—Ç–æ—Ä–∞.'});
    localStorage.setItem(SUPPORT_PUSH_KEY,'1');
  }catch(e){}
}

setTimeout(()=>{if(userEngagementScore>=3){maybeSendSupportPush();}},45000);

// DAY VIEW
function updateNavCenter(){
  const now=new Date();
  const row=DATA[viewIdx]||DATA[todayIdx()];
  const d=row?dateOf(row):now;
  const isViewedToday=row?isToday(row):true;
  const dayLabel=DAYS[d.getDay()];
  const monthLabel=MS[d.getMonth()+1]||'';
  const hh=String(now.getHours()).padStart(2,'0');
  const mm=String(now.getMinutes()).padStart(2,'0');
  const ss=String(now.getSeconds()).padStart(2,'0');
  const ramadanLabel=row?`${row[0]}-–π –¥–µ–Ω—å –†–∞–º–∞–¥–∞–Ω–∞`:'–†–∞–º–∞–¥–∞–Ω';
  const hhNode=$('navClockHours');
  const mmNode=$('navClockMinutes');
  const secNode=$('navCurrentSeconds');
  const ramadanNode=$('navRamadanDay');
  const chipNode=$('navTodayChip');
  if(hhNode)hhNode.textContent=hh;
  if(mmNode)mmNode.textContent=mm;
  if(secNode)secNode.textContent=ss;
  if(chipNode)chipNode.textContent=isViewedToday?'–°–µ–≥–æ–¥–Ω—è':'–í—ã–±—Ä–∞–Ω–Ω—ã–π –¥–µ–Ω—å';
  $('navDateMain').textContent=`${d.getDate()} ${monthLabel} ¬∑ ${dayLabel}`;
  if(ramadanNode)ramadanNode.textContent=ramadanLabel;
}

function renderDay(){
  $('daySectionWrap').style.display='';
  const row=DATA[viewIdx];const t=adj(row);
  const it=isToday(row),il=isLaylatNight(row),ib=isBayram(row);
  // Tab always shows "–î–µ–Ω—å"
  $('tabDay').textContent='–î–µ–Ω—å';
  updateNavCenter();
  $('prevDay').disabled=viewIdx<=0;
  $('nextDay').disabled=viewIdx>=DATA.length-1;
  $('heroImsakTime').textContent=t.imsak;
  $('heroIftarTime').textContent=t.iftar;
  if(document.body.classList.contains('aod-mode')){updateAodPrimaryTiles(t.imsak,t.iftar);}else{restoreDefaultTiles(t.imsak,t.iftar);}
  const pb=$('progressBar');
  if(it){pb.style.display='';updateProgress(t.imsak,t.iftar);}else{pb.style.display='none';}
  const area=$('scheduleArea');let html='';
  if(il)html+=`<div class="notice laylat" style="margin-bottom:9px;"><span class="notice-ico">${row[1]===16?'‚ú®':'üåô'}</span><div><div class="notice-title">–ù–æ—á—å –õ—è–π–ª—è—Ç—É–ª—å-–ö–∞–¥—Ä</div><div class="notice-body">–ù–∞–∏–±–æ–ª–µ–µ –±–ª–∞–≥–æ—Å–ª–æ–≤–µ–Ω–Ω–∞—è –Ω–æ—á—å –†–∞–º–∞–¥–∞–Ω–∞</div></div></div>`;
  if(ib)html+=`<div class="notice bayram"><span class="notice-ico">üéâ</span><div><div class="notice-title">–û—Ä–∞–∑–∞ –ë–∞–π—Ä–∞–º—ã!</div><div class="notice-body">${row[1]===20?'–ù–∞–º–∞–∑ –≤ <strong>7:30</strong>':'–ü—Ä–∞–∑–¥–Ω–∏–∫ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è'}</div></div></div>`;
  area.innerHTML=html;
}

function updateProgress(imsakT,iftarT){
  const n=new Date();
  const nowSec=n.getHours()*3600+n.getMinutes()*60+n.getSeconds();
  const imSec=toMin(imsakT)*60,ifSec=toMin(iftarT)*60;
  const fill=$('progFill'),txt=$('progText'),cnt=$('progCountdown'),lbl=$('progLabel');
  function fmtSec(sec){
    const h=Math.floor(sec/3600);
    const m=Math.floor((sec%3600)/60);
    const s=sec%60;
    return h>0?`${h}—á ${String(m).padStart(2,'0')}–º ${String(s).padStart(2,'0')}—Å`:`${m}–º ${String(s).padStart(2,'0')}—Å`;
  }
  if(nowSec<imSec){
    fill.style.background='var(--imsak)';
    fill.style.width=Math.max(2,(1-((imSec-nowSec)/(90*60)))*100)+'%';
    lbl.style.color='var(--imsak)';txt.textContent='–¢–∞–π–º–µ—Ä –¥–æ –ò–º—Å–∞–∫–∞';cnt.textContent=fmtSec(imSec-nowSec);
  }else if(nowSec<ifSec){
    const tot=ifSec-imSec,pas=nowSec-imSec;
    fill.style.background='linear-gradient(90deg,var(--imsak),var(--iftar))';
    fill.style.width=(pas/tot*100).toFixed(1)+'%';
    lbl.style.color='var(--iftar)';txt.textContent='–¢–∞–π–º–µ—Ä –¥–æ –ò—Ñ—Ç–∞—Ä–∞';cnt.textContent=fmtSec(ifSec-nowSec);
  }else{fill.style.background='var(--iftar)';fill.style.width='100%';lbl.style.color='var(--gold)';txt.textContent='–ò—Ñ—Ç–∞—Ä –Ω–∞—Å—Ç—É–ø–∏–ª';cnt.textContent='–ü—Ä–∏—è—Ç–Ω–æ–≥–æ!';}
}

// WEEK VIEW
function renderWeek(){
  $('daySectionWrap').style.display='none';
  const ti=todayIdx();const start=Math.max(0,ti+weekOff*7);const end=Math.min(DATA.length,start+7);const rows=DATA.slice(start,end);
  $('prevDay').disabled=true;$('nextDay').disabled=true;
  const fl=rows[0]?`${rows[0][1]} ${MS[rows[0][2]]}`:'';const tl=rows[rows.length-1]?`${rows[rows.length-1][1]} ${MS[rows[rows.length-1][2]]}`:'';;
  let h=`<div class="week-nav"><button class="nav-arrow" id="wPrev" ${weekOff<=-Math.ceil(ti/7)?'disabled':''} style="width:34px;height:34px;font-size:16px;">&#8249;</button><div class="week-nav-lbl">${fl} ‚Äî ${tl} ¬∑ ${CITIES[cityIdx].name}</div><button class="nav-arrow" id="wNext" ${end>=DATA.length?'disabled':''} style="width:34px;height:34px;font-size:16px;">&#8250;</button></div><div class="list-card"><div class="list-head"><span>–î–∞—Ç–∞</span><span class="lh-imsak">–ò–º—Å–∞–∫</span><span class="lh-iftar">–ò—Ñ—Ç–∞—Ä</span></div>`;
  rows.forEach(row=>{const t=adj(row);const d=dateOf(row);const it=isToday(row),il=isLaylatNight(row),ib=isBayram(row);let cls='list-row';if(it)cls+=' lr-today';else if(il)cls+=' lr-laylat';else if(ib)cls+=' lr-bayram';let badges='';if(it)badges+='<span class="lr-badge b-today">–°–µ–≥.</span>';if(il&&row[1]===16)badges+='<span class="lr-badge b-laylat">‚ú® –ö–∞–¥—Ä</span>';if(ib&&row[1]===20)badges+='<span class="lr-badge b-bayram">üéâ –ë–∞–π—Ä–∞–º</span>';const ridx=DATA.indexOf(row);h+=`<div class="${cls}" onclick="goDay(${ridx})"><div class="lr-date"><div class="lr-date-day">${DAYS[d.getDay()]}</div><div class="lr-date-main"><div class="lr-date-num">${row[1]} ${MS[row[2]]}</div><div class="lr-date-ramadan">${row[0]}-–π –¥–µ–Ω—å</div></div>${badges}</div><div class="lr-imsak">${t.imsak}</div><div class="lr-iftar">${t.iftar}</div></div>`;});
  h+='</div>';$('scheduleArea').innerHTML=h;
  $('wPrev').onclick=()=>{weekOff--;renderWeek();};
  $('wNext').onclick=()=>{weekOff++;renderWeek();};
}

// MONTH VIEW
function renderMonth(){
  $('daySectionWrap').style.display='none';
  $('prevDay').disabled=true;$('nextDay').disabled=true;
  const bayramDays={20:'–ù–∞–º–∞–∑ –≤ 7:30',21:'',22:''};
  let h='';const byM={};DATA.forEach(r=>{if(!byM[r[2]])byM[r[2]]=[];byM[r[2]].push(r);});
  Object.keys(byM).forEach(mk=>{
    const m=parseInt(mk);const monthRows=byM[m];
    const minDay=monthRows[0][1],maxDay=monthRows[monthRows.length-1][1];
    const firstDataDow=new Date(2026,m-1,minDay).getDay();
    const startOffset=(firstDataDow===0?6:firstDataDow-1);
    h+=`<div class="section-lbl" style="margin-bottom:8px;">${MF[m]} 2026 ¬∑ ${CITIES[cityIdx].name}</div><div class="month-grid-header">`;
    ['–ü–Ω','–í—Ç','–°—Ä','–ß—Ç','–ü—Ç','–°–±','–í—Å'].forEach(d=>{h+=`<div class="mgh-day">${d}</div>`;});
    h+=`</div><div class="month-grid">`;
    for(let i=0;i<startOffset;i++)h+='<div class="mg-cell mc-empty"></div>';
    for(let day=minDay;day<=maxDay;day++){
      if(m===3&&bayramDays[day]!==undefined){
        const bayramTime=bayramDays[day];
        h+=`<div class="mg-cell mc-bayram"><span class="mc-badge">üéâ</span><div class="mc-num">${day}</div><div class="mc-bayram-title">–ë–∞–π—Ä–∞–º</div><div class="mc-bayram-note">–î–Ω–∏ –ë–∞–π—Ä–∞–º–∞</div>${bayramTime?`<div class="mc-bayram-time">${bayramTime}</div>`:''}</div>`;
        continue;
      }
      const row=DATA.find(r=>r[1]===day&&r[2]===m);
      if(!row)continue;
      const t=adj(row);const it=isToday(row),il=isLaylat(row),ib=isBayram(row);let cls='mg-cell';if(it)cls+=' mc-today';if(il)cls+=' mc-laylat';if(ib)cls+=' mc-bayram';let bdg='';if(il)bdg='<span class="mc-badge">‚ú®</span>';const ridx=DATA.indexOf(row);
      h+=`<div class="${cls}" onclick="goDay(${ridx})">${bdg}<div class="mc-num">${day}</div><div class="mc-ramadan">${row[0]}-–π –¥–µ–Ω—å</div><div class="mc-imsak">${t.imsak}</div><div class="mc-iftar">${t.iftar}</div></div>`;
    }
    h+=`</div><div style="height:16px;"></div>`;
  });
  $('scheduleArea').innerHTML=h;
}

// Update hero block without full re-render (for week/month cell taps)
function _updateHero(idx){
  viewIdx=idx;
  const row=DATA[idx];const t=adj(row);const it=isToday(row);
  updateNavCenter();
  $('heroImsakTime').textContent=t.imsak;
  $('heroIftarTime').textContent=t.iftar;
  if(document.body.classList.contains('aod-mode')){updateAodPrimaryTiles(t.imsak,t.iftar);}else{restoreDefaultTiles(t.imsak,t.iftar);}
  if(it){$('progressBar').style.display='';updateProgress(t.imsak,t.iftar);}else{$('progressBar').style.display='none';}
}

function renderAll(){if(mode==='day')renderDay();else if(mode==='week')renderWeek();else renderMonth();}
function goDay(idx){viewIdx=idx;mode='day';document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));document.querySelector('[data-mode="day"]').classList.add('active');$('prevDay').disabled=false;$('nextDay').disabled=false;renderAll();window.scrollTo({top:0,behavior:'smooth'});}
document.querySelectorAll('.tab').forEach(tab=>{tab.onclick=()=>{
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  tab.classList.add('active');
  const newMode=tab.dataset.mode;
  if(newMode==='day'){
    // "–°–µ–≥–æ–¥–Ω—è" tab always returns to today
    viewIdx=todayIdx();
    $('prevDay').disabled=false;$('nextDay').disabled=false;
  }
  mode=newMode;weekOff=0;renderAll();
};});
$('prevDay').onclick=()=>{if(viewIdx>0){viewIdx--;renderDay();}};
$('nextDay').onclick=()=>{if(viewIdx<DATA.length-1){viewIdx++;renderDay();}};

// PRAYER
function showPrayer(type){const p=PRAYERS[type];const row=DATA[viewIdx];const t=adj(row);const time=type==='imsak'?t.imsak:t.iftar;const color=type==='imsak'?'var(--imsak)':'var(--iftar)';$('prayerContent').innerHTML=`<div class="prayer-badge ${type==='imsak'?'pb-imsak':'pb-iftar'}">${p.badge}</div><div class="prayer-time" style="color:${color};">${time}</div><div class="prayer-city">${CITIES[cityIdx].name} ¬∑ ${row[1]} ${MS[row[2]]}</div><div class="prayer-card"><div class="prayer-arabic">${p.arabic}</div><div class="prayer-translit">${p.translit}</div><div class="prayer-translation">${p.text}</div>${p.placeholder?'<div class="prayer-note">üí¨ –ú–æ–∂–Ω–æ –ø—Ä–æ–∏–∑–Ω–µ—Å—Ç–∏ –ø—Ä–æ —Å–µ–±—è</div>':''}</div>`;openSheet('prayerSheet');}
$('imsakCard').onclick=()=>showPrayer('imsak');
$('iftarCard').onclick=()=>showPrayer('iftar');

// CALENDAR ICS
function buildICS(){const city=CITIES[cityIdx];let s=['BEGIN:VCALENDAR','VERSION:2.0','PRODID:-//Ramadan1447//Crimea//RU','CALSCALE:GREGORIAN',`X-WR-CALNAME:–†–∞–º–∞–¥–∞–Ω 1447 ¬∑ ${city.name}`,'X-WR-TIMEZONE:Europe/Simferopol'].join('\r\n')+'\r\n';DATA.forEach(row=>{const t=adj(row);const y=2026,m=String(row[2]).padStart(2,'0'),d=String(row[1]).padStart(2,'0');const im=t.imsak.replace(':','').padStart(4,'0');const if2=t.iftar.replace(':','').padStart(4,'0');s+=`BEGIN:VEVENT\r\nUID:imsak-${y}${m}${d}@ram1447\r\nSUMMARY:üåô –ò–º—Å–∞–∫ ${t.imsak}\r\nDTSTART:${y}${m}${d}T${im}00\r\nDURATION:PT1M\r\nEND:VEVENT\r\n`;s+=`BEGIN:VEVENT\r\nUID:iftar-${y}${m}${d}@ram1447\r\nSUMMARY:üåø –ò—Ñ—Ç–∞—Ä ${t.iftar}\r\nDTSTART:${y}${m}${d}T${if2}00\r\nDURATION:PT1M\r\nEND:VEVENT\r\n`;});s+='BEGIN:VEVENT\r\nUID:laylat@ram1447\r\nSUMMARY:‚ú® –ù–æ—á—å –õ—è–π–ª—è—Ç—É–ª—å-–ö–∞–¥—Ä\r\nDTSTART:20260316T200000\r\nDTEND:20260317T060000\r\nEND:VEVENT\r\nBEGIN:VEVENT\r\nUID:bayram-namaz@ram1447\r\nSUMMARY:üéâ –ù–∞–º–∞–∑ –û—Ä–∞–∑–∞ –±–∞–π—Ä–∞–º—ã\r\nDTSTART:20260320T073000\r\nDTEND:20260320T083000\r\nEND:VEVENT\r\nBEGIN:VEVENT\r\nUID:bayram@ram1447\r\nSUMMARY:üéâ –û—Ä–∞–∑–∞ –ë–∞–π—Ä–∞–º—ã\r\nDTSTART:20260320\r\nDTEND:20260323\r\nEND:VEVENT\r\n';s+='END:VCALENDAR';return s;}
function downloadICS(){const city=CITIES[cityIdx];const blob=new Blob([buildICS()],{type:'text/calendar;charset=utf-8'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=`ramadan-1447-${city.name}.ics`;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);closeSheet('calSheet');}
$('icsBtn').onclick=downloadICS;
$('googleBtn').onclick=()=>{alert('1. –°–∫–∞—á–∞–π—Ç–µ .ics —Ñ–∞–π–ª (–∫–Ω–æ–ø–∫–∞ –≤—ã—à–µ)\n2. –û—Ç–∫—Ä–æ–π—Ç–µ calendar.google.com\n3. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª');};

// PWA INSTALL
window.addEventListener('beforeinstallprompt',e=>{e.preventDefault();installPrompt=e;if(!localStorage.getItem('ramInstallDismissed')){$('installBanner').style.display='flex';}$('androidInstallBtn').style.display='block';});
$('installBanner').onclick=e=>{if(e.target.id==='installBannerClose')return;if(installPrompt){installPrompt.prompt();installPrompt.userChoice.then(()=>{installPrompt=null;});}else{openSheet('installSheet');}};
$('installBannerClose').onclick=e=>{e.stopPropagation();$('installBanner').style.display='none';localStorage.setItem('ramInstallDismissed','1');};
const pid=$('promptInstallBtn');if(pid)pid.onclick=()=>{if(installPrompt){installPrompt.prompt();installPrompt.userChoice.then(()=>{installPrompt=null;closeSheet('installSheet');});}};
window.addEventListener('appinstalled',()=>{$('installBanner').style.display='none';closeSheet('installSheet');});


// SERVICE WORKER
if('serviceWorker' in navigator){navigator.serviceWorker.register('./sw.js').then(()=>{}).catch(()=>{});}

const READ_PROGRESS_KEY = 'ramReadProgress';
const READ_COMPAT_KEY = 'ramReadArticles';

function parseStoredObject(key){
  try{const parsed=JSON.parse(localStorage.getItem(key)||'{}');return parsed&&typeof parsed==='object'?parsed:{};}catch(e){return {};}
}

function updateMaterialsUnreadBadge(){
  const badge=$('materialsUnreadBadge');
  if(!badge||!window.ContentRelease)return;
  const progress=parseStoredObject(READ_PROGRESS_KEY);
  const compat=parseStoredObject(READ_COMPAT_KEY);
  const release=window.ContentRelease.getReleaseState();
  const readCount=release.availableArticles.filter(a=>Boolean((progress[a.id]&&progress[a.id].completed)||compat[a.id])).length;
  const unread=Math.max(0,release.availableCount-readCount);
  badge.textContent=String(unread);
  badge.classList.toggle('show',unread>0);
}

function updateZakatAccessState(){
  if(!window.ContentRelease)return;
  const fitirCard=$('fitirCard');
  const amountLink=$('fitirAmountLink');
  if(!fitirCard||!amountLink)return;
  const release=window.ContentRelease.getReleaseState();
  if(release.allZakatPublished){
    fitirCard.style.cursor='pointer';
    fitirCard.onclick=()=>{window.location.href='zakat.html';};
    fitirCard.setAttribute('title','–ü–µ—Ä–µ–π—Ç–∏ –≤ —Ä–∞–∑–¥–µ–ª ¬´–ó–∞–∫—è—Ç –≤ –ò—Å–ª–∞–º–µ¬ª');
  }else{
    fitirCard.onclick=null;
    fitirCard.style.cursor='default';
    fitirCard.removeAttribute('title');
  }
}

function showLandscapeFeatureNotice(){
  const notice=$('landscapeFeatureNotice');
  if(!notice)return;
  if(localStorage.getItem(FEATURE_NOTICE_KEY)==='1')return;
  notice.style.display='flex';
  const close=()=>{notice.style.display='none';localStorage.setItem(FEATURE_NOTICE_KEY,'1');};
  const btn=$('landscapeFeatureNoticeBtn');
  if(btn)btn.onclick=close;
}

function showPostsNotice(release){
  const wrap=$('newPostsNotice');
  const title=$('newPostsNoticeTitle');
  const body=$('newPostsNoticeBody');
  const openBtn=$('newPostsNoticeOpen');
  const dismissBtn=$('newPostsNoticeDismiss');
  if(!wrap||!title||!body||!dismissBtn||!openBtn)return;
  const seen=Number(localStorage.getItem(POSTS_NOTICE_SEEN_KEY)||'0');
  const fresh=Math.max(0,release.availableCount-seen);
  if(fresh<=0){wrap.style.display='none';return;}
  title.textContent=fresh===1?'–í—ã—à–µ–ª –Ω–æ–≤—ã–π –ø–æ—Å—Ç':'–í—ã—à–ª–∏ –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã';
  body.textContent=fresh===1?`–î–æ–±–∞–≤–ª–µ–Ω –º–∞—Ç–µ—Ä–∏–∞–ª: ${release.availableArticles[release.availableCount-1].title}.`:`–î–æ–±–∞–≤–ª–µ–Ω–æ ${fresh} –Ω–æ–≤—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–ü–æ–∑–Ω–∞–≤–∞—Ç–µ–ª—å–Ω–æ¬ª.`;
  wrap.style.display='flex';
  const markSeen=()=>{localStorage.setItem(POSTS_NOTICE_SEEN_KEY,String(release.availableCount));wrap.style.display='none';};
  dismissBtn.onclick=markSeen;
  openBtn.onclick=()=>{markSeen();};
}

function processAutoReleases(){
  if(!window.ContentRelease)return;
  const release=window.ContentRelease.getReleaseState();
  window.ContentRelease.showReleaseNotification(release);
  showPostsNotice(release);
}

window.addEventListener('storage',e=>{
  if(e.key===READ_PROGRESS_KEY||e.key===READ_COMPAT_KEY||e.key===window.ContentRelease.RELEASE_START_KEY){
    updateMaterialsUnreadBadge();
    updateZakatAccessState();
  }
});

// INIT
applyAodMode();
showLandscapeFeatureNotice();
processAutoReleases();
updateMaterialsUnreadBadge();
updateZakatAccessState();
viewIdx=todayIdx();
renderAll();
setInterval(()=>{
  updateNavCenter();
  if(mode==='day'){
    const current=adj(DATA[viewIdx]);
    if(document.body.classList.contains('aod-mode')){updateAodPrimaryTiles(current.imsak,current.iftar);}
    if(isToday(DATA[viewIdx])){updateProgress(current.imsak,current.iftar);}
  }
},1000);
</script>

<!-- Yandex.Metrika counter -->


<script defer src="metrics.js"></script>
<noscript><div><img src="https://mc.yandex.ru/watch/106936532" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

</body>
</html>
